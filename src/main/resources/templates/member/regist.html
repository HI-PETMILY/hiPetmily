<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script defer type="text/javascript" src="/js/main/mainPage.js"></script>

    <link rel="icon" type="image/x-icon" sizes="16x16" href="/static_Image/common/main/favicon.ico">
    <link href="https://unpkg.com/ress/dist/ress.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="/css/member/regist.css"/>
    <link rel="stylesheet" href="/css/common/headerFooter.css"/>


</head>

<body>

<div th:replace="common/header_white.html"></div>

<div class="con_container">
    <div class="style_container">
            <span>
                <h2>회원가입</h2>
            </span>
        <form action="/member/regist" method="post">
        <div>
            <div class="notice1">
                * 은 필수 입력 사항입니다.
                <div>
                    <div class="container">
                        <span>
                            <input type="text" name="memberId" id="email" placeholder=" * 이메일"
                                   onfocus="this.placeholder=''" onblur="this.placeholder=' * 이메일'" required>
                        </span>
                    </div>

                    <div>
                        <div class="container">
                        <span>
                            <input type="text" maxlength="6" name="memberName" id="name" placeholder=" * 이름"
                                   onfocus="this.placeholder=''" onblur="this.placeholder=' * 이름'" required>
                        </span>
                        </div>
                    </div>
                    <div>
                        <div class="container">
                        <span>
                            <input type="text" maxlength="13" name="nickName" id="nickName"
                                   placeholder=" * 닉네임" onfocus="this.placeholder=''" onblur="this.placeholder=' * 닉네임'"
                                   required>

                            <input type="button" value="중복확인" id="duplicationCheck">
                        </span>
                        </div>
                    </div>
                    <div>
                        <div class="container">
                        <span>
                            <input type="password" maxlength="13" name="memberPwd" id="password"
                                   placeholder=" * 비밀번호" onfocus="this.placeholder=''"
                                   onblur="this.placeholder=' * 비밀번호'" required>
                        </span>
                        </div>
                    </div>
                    <div>
                        <div class="container">
                        <span>
                            <input type="password" maxlength="15" name="memberPwd2" id="password2"
                                   placeholder=" * 비밀번호 확인" onfocus="this.placeholder=''"
                                   onblur="this.placeholder=' * 비밀번호 확인'" required>
                        </span>
                        </div>
                    </div>
                    <div>
                        <div class="container">
                        <span>
                            <input type="text" maxlength="15" name="phone" id="phone" placeholder=" * 휴대전화"
                                   onfocus="this.placeholder=''" onblur="this.placeholder=' * 휴대전화'"  required>
                        </span>
                        </div>
                    </div>

                    <div id="gender-row">
                        <div id="gender-label" class="container">성별</div>
                        <div id="gender-container" class="container">
                            <label class="gender-fe">
                                <input type="radio" name="gender" value="F" checked="checked"/>
                                <span class="female">여성</span>
                            </label>
                            <label class="gender-me">
                                <input type="radio" value="M" name="gender"/>
                                <span class="male">남성</span>
                            </label>
                        </div>
                    </div>
                    <div>
                        <div id="centerLine" class="container">
                            <input type="text" value="" name="postNo" id="zipcode" placeholder=" 우편번호 (선택)" readonly>
                            <input type="button" value="우편번호 검색" id="searchZipCode">
                        </div>
                    </div>
                    <div>
                        <input type="text" name="address" id="address1" placeholder=" 기본주소" readonly>

                    </div>
                    <div>
                        <input type="text" name="address2" id="address2" placeholder=" 상세주소 입력">
                    </div>

                    <div class="checkbox_group">
                        <div>
                            <input type="checkbox" id="check_all">
                            <label for="check_all">전체동의</label>
                        </div>
                        <div>
                            <input type="checkbox" class="normal required" id="check_1">
                            <label for="check_1">만 14세 이상입니다. [필수] </label>
                        </div>
                        <div>
                            <input type="checkbox" class="normal required" id="check_2">
                            <label for="check_2">펫밀리 이용 약관 동의 [필수]</label>
                            <span><a href="/board/terms" style="text-decoration: none; color: #81BDF1;" class="a_text" id="aa_text">내용보기</a></span>
                        </div>
                        <div>
                            <input type="checkbox" class="normal required" id="check_3">
                            <label for="check_3">개인정보 수집 및 이용 동의 [필수]</label>
                            <span><a href="/board/policy" style="text-decoration: none; color: #81BDF1;" class="a_text">내용보기</a></span>
                        </div>
                    </div>
                </div>
                <br>
                <div class="regist_button">
                    <input type="submit" name="regist_button" id="regist_button" value="가입하기" disabled>
                </div>

            </div>
        </div>
        </form>
    </div>
</div>

                <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
                <script>


                    const $searchZipCode = document.getElementById("searchZipCode");

                    $searchZipCode.onclick = function () {
                        new daum.Postcode({
                            oncomplete: function (data) {
                                document.getElementById("zipcode").value = data.zonecode;
                                document.getElementById("address1").value = data.address;
                                document.getElementById("address2").focus(); // 사용자가 그냥 쓸 수 있게 커서 넣는 focus
                            }
                        }).open();
                    }



                    /* =============================================================================
                                                           regist.html
                     =============================================================================== */


                    /* 유효성 검사 나중에 ===================================== */

                    /* 닉네임 중복 확인 */
                    if(document.getElementById("duplicationCheck")) {

                        const $duplication = document.getElementById("duplicationCheck");

                        $duplication.onclick = function() {
                            let nickName = document.getElementById("nickName").value.trim();

                            fetch("/member/nickNameDupCheck", {
                                method: "POST",
                                headers: {
                                    'Content-Type': 'application/json;charset=UTF-8'
                                },
                                body: JSON.stringify({nickName: nickName})
                            })
                                .then(result => result.text())
                                .then(result => alert(result))
                                .catch((error) => error.text().then((res) => alert(res)));

                        }
                    }


                    /* input에 영어랑 숫자만 입력하게 하기 - 이메일 */
                    const inputEngNum = document.getElementById('email');
                    inputEngNum.addEventListener('input', function (event) {
                        const inputValue = event.target.value;
                        // event.target은 이벤트를 발생시킨 요소를 가리킨다. -> 입력필드
                        event.target.value = inputValue.replace(/[^\w\s@.]/ig, '');
                        // event.target.value는 입력 필드의 현재 값을 나타낸다.
                        // => 정규 표현식을 사용하여 입력을 필터링하고, 필터링된 결과를 다시 입력 필드에 할당하여 불필요한 문자를 제거한다.
                    });


                    /* input에 영어랑 숫자, 특수문자 입력하게 하기 - 패스워드 */
                    const inputAll = document.getElementById('password');
                    inputAll.addEventListener('input', function (event) {
                        const inputValue2 = event.target.value;
                        event.target.value = inputValue2.replace(/[^A-Za-z0-9!@#$%^&*()_+{}\[\]:;<>,.?~\\-]/g, '');
                    });


                    /* input에 숫자 입력하게 하기 - 연락처 */
                    const inputNum = document.getElementById('phone');
                    inputNum.addEventListener('input', function (event) {
                        const inputValue3 = event.target.value;
                        event.target.value = inputValue3.replace(/\D/g, '');
                    });


                    /* 전체 동의 */
                    const checkAll = document.getElementById("check_all");
                    const normalCheckboxes = document.querySelectorAll(".normal");

                    checkAll.addEventListener("click", function () {
                        normalCheckboxes.forEach(function (checkbox) {
                            checkbox.checked = checkAll.checked;
                        });

                        updateSubmitButtonState();
                    });

                    /* 개별 체크박스의 클릭 이벤트 핸들러(전체 동의 체크 상태 업데이트) */
                    normalCheckboxes.forEach(function (checkbox) {
                        checkbox.addEventListener("click", function () {
                            var is_checked = true;
                            normalCheckboxes.forEach(function (checkbox) {
                                if (!checkbox.checked) {
                                    is_checked = false;
                                }
                            });
                            checkAll.checked = is_checked;

                            updateSubmitButtonState();
                        });
                    });

                    /* 필수 약관 체크박스 눌렀을 때 가입 버튼 활성화 */
                    const requiredCheckboxes = document.querySelectorAll(".required");
                    const submitButton = document.querySelector(".regist_button input[type='submit']");


                    // 필수 약관 체크박스들 상태 체크
                    function updateSubmitButtonState() {
                        var allRequiredChecked = true;

                        // 모든 필수 약관 체크 여부 확인
                        requiredCheckboxes.forEach(function (checkbox) {
                            if (!checkbox.checked) {
                                allRequiredChecked = false;
                            }
                        });

                        submitButton.disabled = !allRequiredChecked;
                    }

                    updateSubmitButtonState();

                </script>
        <div th:replace="common/footer.html"></div>
</body>
</html>